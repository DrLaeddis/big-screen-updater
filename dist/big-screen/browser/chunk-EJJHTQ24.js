import{a as K}from"./chunk-TF2CSF5F.js";import{a as G}from"./chunk-7W76JT5L.js";import{a as U}from"./chunk-6HXTQR5D.js";import{a as L,b as V}from"./chunk-JWDGFI55.js";import{g as Q,h as q,i as E,j as P}from"./chunk-PQNYVRMP.js";import{a as j}from"./chunk-K3YAW35H.js";import{$a as Y,Ba as k,Ca as c,Da as z,Ha as s,Ia as l,Ja as v,Ka as N,La as H,Ma as I,N as x,Na as g,Oa as u,Ra as M,S as T,Sa as $,Ta as O,Ua as W,Va as h,W as C,Wa as F,Xa as R,Za as D,_a as B,ab as J,ca as m,da as f,ia as y,o as w,oa as _,ra as a,sa as b,x as S}from"./chunk-WH7RZBSH.js";var oe=(n,o)=>({"border-primary":n,"border-secondary":o}),ne=n=>({"scale-110":n});function re(n,o){if(n&1&&(s(0,"div",17),h(1),l()),n&2){let d=u();a(),R(" ",d.countdown," ")}}var Z=(()=>{let o=class o{constructor(e){this.websocketService=e,this.playSample="play-sample.svg",this.information="information.svg",this.favoriteChecked="favorite-checked.svg",this.favoriteUnchecked="favorite-unchecked.svg",this.presetData=[],this.countdown=0,this.isPlaying=!1,this.isFavorite=!1,this.selected=!1,this.favoriteToggled=new y,this.trackSelected=new y,this.isCountdownActive=!1,this.countdownStatusChanged=new y}ngOnInit(){let e=localStorage.getItem("presetData");e?this.presetData=JSON.parse(e):console.log("No preset data in storage")}handleFavorite(){this.favoriteToggled.emit()}selectTrack(){this.trackSelected.emit()}handlePreview(e){if(this.isCountdownActive||this.isPlaying)return;this.isPlaying=!0,this.countdownStatusChanged.emit(!0),e.stopPropagation();let i={preset:this.presetData,soundscape:this.track.soundscape,duration:this.track.duration},t=JSON.stringify(i);this.websocketService.sendMessage("playWRP",`{"sample": "preview",  ${t.slice(1,-1)}}`),this.startCountdown()}startCountdown(){this.countdown=10;let e=setInterval(()=>{this.countdown--,this.countdown<=0&&(clearInterval(e),this.countdownStatusChanged.emit(!1),this.isPlaying=!1)},1e3)}};o.\u0275fac=function(i){return new(i||o)(b(j))},o.\u0275cmp=C({type:o,selectors:[["app-track-item"]],inputs:{track:"track",isFavorite:"isFavorite",selected:"selected",isCountdownActive:"isCountdownActive"},outputs:{favoriteToggled:"favoriteToggled",trackSelected:"trackSelected",countdownStatusChanged:"countdownStatusChanged"},standalone:!0,features:[D],decls:23,vars:16,consts:[[1,"w-full","h-full","flex","flex-row","items-center","justify-between","border-4","rounded-full","py-5","px-3","bg-secondary/20",3,"click","ngClass"],[1,"w-1/2","flex","flex-col","text-center","px-5"],[1,"text-xl","tracking-wide"],[1,"text-lg","italic","text-secondary"],[1,"border-2","border-secondary","h-[90%]"],[1,"w-1/2","flex","flex-row","items-center","justify-between","px-5"],[1,"w-fit","flex","flex-col","items-center","justify-center","leading-none","gap-2"],[1,"text-md"],[1,"text-4xl"],["alt","Play Sample",1,"w-14","active:scale-90","duration-300","relative","flex","items-center",3,"click","disabled"],["alt","",3,"src"],["class","bg-[#116031] absolute w-full h-[50px] flex items-center justify-start pl-[11px]","style","clip-path: polygon(0 0, 100% 50%, 0 100%);",4,"ngIf"],[1,"w-fit","flex","flex-col","items-start","justify-center","gap-2"],[1,"duration-300","active:scale-90"],["alt","Preset Information",1,"w-8","active:scale-90","duration-300",3,"src"],[1,"duration-300","active:scale-90",3,"click"],["alt","Favorite Icon",1,"w-8","transition-transform","duration-300","ease-in-out",3,"ngClass","src"],[1,"bg-[#116031]","absolute","w-full","h-[50px]","flex","items-center","justify-start","pl-[11px]",2,"clip-path","polygon(0 0, 100% 50%, 0 100%)"]],template:function(i,t){i&1&&(s(0,"div",0),g("click",function(){return t.selectTrack()}),s(1,"div",1)(2,"h3",2),h(3),l(),s(4,"p",3),h(5," By: "),s(6,"span"),h(7),l()()(),v(8,"hr",4),s(9,"div",5)(10,"div",6)(11,"h3",7),h(12,"Track Duration"),l(),s(13,"p",8),h(14),l()(),s(15,"button",9),g("click",function(p){return t.handlePreview(p)}),v(16,"img",10),k(17,re,2,1,"div",11),l(),s(18,"div",12)(19,"button",13),v(20,"img",14),l(),s(21,"button",15),g("click",function(p){return t.handleFavorite(),p.stopPropagation()}),v(22,"img",16),l()()()()),i&2&&(c("ngClass",Y(11,oe,t.selected,!t.selected)),a(3),F(t.track.title),a(4),F(t.track.caption),a(7),F(t.track.duration),a(),c("disabled",t.isCountdownActive)("disabled",t.isPlaying),a(),c("src",t.playSample,_),a(),c("ngIf",t.countdown>0),a(3),c("src",t.information,_),a(2),c("ngClass",B(14,ne,t.isFavorite))("src",t.isFavorite?t.favoriteChecked:t.favoriteUnchecked,_))},dependencies:[P,Q,E]});let n=o;return n})();var X=(()=>{let o=class o{constructor(e){this.http=e,this.apiUrl="http://localhost:3000/mobile-api/selftdevelopmentsound"}getselftdevelopmentSound(){let e=localStorage.getItem("Token");if(!e)throw new Error("Token not found");let i=new L({"X-Authorization":`${e}`});return this.http.get(this.apiUrl,{headers:i}).pipe(S(t=>w(()=>t)))}};o.\u0275fac=function(i){return new(i||o)(T(V))},o.\u0275prov=x({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();var ee=(()=>{let o=class o{constructor(e){this.http=e,this.apiUrl="http://localhost:3000/mobile-api/userFavoriteSelfDevSound"}getHeaders(){let e=localStorage.getItem("Token");if(!e)throw new Error("Unauthorized");return new L({"X-Authorization":`${e}`})}userFavoriteSelfDevSound(){let e=this.getHeaders();return this.http.get(this.apiUrl,{headers:e}).pipe(S(i=>w(()=>i)))}postUserFavoriteSelfDevSound(e){let i=this.getHeaders();return this.http.post(this.apiUrl,{self_development_sound_id:e},{headers:i}).pipe(S(t=>w(()=>t)))}deleteUserFavoriteSelfDevSound(e){let i=this.getHeaders();return this.http.delete(`${this.apiUrl}/${e}`,{headers:i}).pipe(S(t=>w(()=>t)))}};o.\u0275fac=function(i){return new(i||o)(T(V))},o.\u0275prov=x({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();function ce(n,o){if(n&1&&(s(0,"div",21),v(1,"app-door",22),l()),n&2){let d=u();a(),c("isClose",d.doorClosed)}}function de(n,o){if(n&1){let d=I();s(0,"app-track-item",25),g("countdownStatusChanged",function(i){let t=m(d).index,r=u(2);return f(r.handleCountdownStatus(i,t))})("favoriteToggled",function(){let i=m(d),t=i.$implicit,r=i.index,p=u(2);return f(p.toggleFavorite(t,p.x[r]))})("trackSelected",function(){let i=m(d).$implicit,t=u(2);return f(t.selectedTrack(i))}),l()}if(n&2){let d=o.$implicit,e=o.index,i=u(2);c("track",d)("isFavorite",d.isFavorite)("isCountdownActive",i.activeCountdownIndex!==null&&i.activeCountdownIndex!==e)("selected",d.sound_code===i.selectedTrackSoundCode)}}function pe(n,o){if(n&1&&(N(0),s(1,"div",23),k(2,de,1,4,"app-track-item",24),l(),H()),n&2){let d=u();a(2),c("ngForOf",d.trackList)}}function ue(n,o){if(n&1){let d=I();s(0,"app-track-item",25),g("countdownStatusChanged",function(i){let t=m(d).index,r=u(2);return f(r.handleCountdownStatus(i,t))})("favoriteToggled",function(){let i=m(d),t=i.$implicit,r=i.index,p=u(2);return f(p.toggleFavorite(t,p.x[r]))})("trackSelected",function(){let i=m(d).$implicit,t=u(2);return f(t.selectedTrack(i))}),l()}if(n&2){let d=o.$implicit,e=o.index,i=u(2);c("track",d)("isFavorite",!0)("isCountdownActive",i.activeCountdownIndex!==null&&i.activeCountdownIndex!==e)("selected",d.sound_code===i.selectedTrackSoundCode)}}function me(n,o){if(n&1&&(s(0,"div",23),k(1,ue,1,4,"app-track-item",24),l()),n&2){let d=u();a(),c("ngForOf",d.favoritesList)}}var Pe=(()=>{let o=class o{constructor(e,i,t){this.websocketService=e,this.selfDevelopmentSound=i,this.favoriteSound=t,this.regenesisLogo="logo-w-name.svg",this.playSample="play-sample.svg",this.information="information.svg",this.favoriteChecked="favorite-checked.svg",this.favoriteUnchecked="favorite-unchecked.svg",this.backButton="back-button.svg",this.homeButton="home-button.svg",this.selectedTab="sessionLibrary",this.isFavorite=!1,this.presetData=[],this.token="",this.selectedTrackData=null,this.selectedTrackSoundCode=null,this.trackList=[],this.x=[],this.userFavorites=[],this.a=0,this.favoritesList=[],this.activeCountdownIndex=null,this.doorClosed=!1,this.stopDoorAnimation=!1}ngOnInit(){setTimeout(()=>{let e=localStorage.getItem("Token");console.log("JWT Token from localStorage:",e);let i=localStorage.getItem("selectSelfDev");this.selfDevelopmentSound.getselftdevelopmentSound().subscribe({next:r=>{this.x=r.filter(p=>p.self_development_id===i),console.log("All track: ",r),this.updateTrackList()},error:r=>{console.error("Error fetching sounds:",r)}}),this.favoriteSound.userFavoriteSelfDevSound().subscribe({next:r=>{this.userFavorites=r,this.updateTrackFavList(),this.updateTrackList()},error:r=>{console.error("Error fetching favorites:",r)}});let t=localStorage.getItem("presetData");if(t)try{this.presetData=JSON.parse(t)}catch{console.error("Failure to convert data from localStorage")}else console.log("No data preset found in localStorage");console.log("check presetData",this.presetData),this.token=localStorage.getItem("Token")||""})}handleCountdownStatus(e,i){this.activeCountdownIndex=e?i:null}updateTrackFavList(){this.x.length&&this.userFavorites.length&&(this.favoritesList=this.x.filter(e=>this.userFavorites.some(i=>i.self_development_sound_id===e.id)).map(e=>({sound_code:e.sound_code,title:e.title,caption:e.caption,duration:e.duration,favoriteId:e.id,isFavorite:!0,soundscape:e.sound_code})),console.log("this.trackList",this.trackList))}updateTrackList(){this.trackList=this.x.map(e=>{let i=this.userFavorites.some(t=>t.self_development_sound_id===e.id);return{sound_code:e.sound_code,title:e.title,caption:e.caption,duration:e.duration,favoriteId:e.id,isFavorite:i,soundscape:e.sound_code}}),console.log("Updated trackList with all items:",this.trackList)}selectTab(e){this.selectedTab!==e&&(this.selectedTab=e,this.selectedTrackSoundCode=null,this.selectedTrackData=null,console.log("Selection cleared when switching tabs"))}favorite(e,i){e.isFavorite=!0,this.favoriteSound.postUserFavoriteSelfDevSound(i.id).subscribe({next:t=>{console.log("Check response: ",t),e.favoriteId=t.id,this.favoritesList.includes(e)||this.favoritesList.push(e),console.log("Sound added to favorites with new favorite ID:",t.id)},error:t=>{console.error("Error adding sound to favorites:",t)}})}unfavorite(e,i){e.isFavorite=!1,this.favoriteSound.deleteUserFavoriteSelfDevSound(e.favoriteId).subscribe({next:()=>{this.favoritesList=this.favoritesList.filter(t=>t!==e),console.log("Sound removed from favorites:",i)},error:t=>{console.error("Error removing sound from favorites:",t)}})}toggleFavorite(e,i){e.isFavorite===!0?this.unfavorite(e,i):this.favorite(e,i)}selectedTrack(e){this.selectedTrackSoundCode===e.sound_code?(this.selectedTrackSoundCode=null,this.selectedTrackData=null,console.log("Track deselected")):(this.selectedTrackSoundCode=e.sound_code,this.selectedTrackData={soundCode:e.sound_code,duration:e.duration},console.log("Selected Track \u{1F44C}:",e),console.log("Selected Sound Code \u{1F194}:",this.selectedTrackData.soundCode),console.log("Selected Duration \u23F3:",this.selectedTrackData.duration))}backToSelecSelfDev(){if(!this.token){console.log("token not found");return}this.websocketService.sendMessage("gotoSelfDev",localStorage.getItem("presetId"),this.token)}playWRP(){if(!this.selectedTrackData){console.warn("No track selected!");return}let e={preset:this.presetData,soundscape:this.selectedTrackData.soundCode,duration:this.selectedTrackData.duration};console.log("Sending WRP Data:",e);let i=JSON.stringify(e);this.websocketService.sendMessage("playWRP",`{"sample": "full",  ${i.slice(1,-1)}}`),console.log(i)}customizeYourEnvironment(){if(!this.token){console.log("token not found");return}this.stopDoorAnimation=!0,this.doorClosed=!0,setTimeout(()=>{this.doorComponent.transitionEnded.subscribe(e=>{e==="right"&&(this.websocketService.sendMessage("gotoWorkrestPlay","",this.token),console.log("Click Customize Your Environment Clicked!"))})})}gotoHome(){if(!this.token){console.log("token not found");return}this.stopDoorAnimation=!0,this.doorClosed=!0,setTimeout(()=>{this.doorComponent.transitionEnded.subscribe(e=>{e==="right"&&setTimeout(()=>{this.websocketService.sendMessage("gotoHome","",this.token)},500)})})}onDoorTransitionEnd(e){console.log("Transition ended:",e),this.doorClosed=!1}};o.\u0275fac=function(i){return new(i||o)(b(j),b(X),b(ee))},o.\u0275cmp=C({type:o,selectors:[["app-task56"]],viewQuery:function(i,t){if(i&1&&M(U,5),i&2){let r;$(r=O())&&(t.doorComponent=r.first)}},standalone:!0,features:[D],decls:26,vars:21,consts:[["favorites",""],["class","w-screen h-screen bg-transparent absolute pointer-events-none z-50",4,"ngIf"],[3,"backgroundImage"],[1,"w-[85%]","h-full","flex","flex-col","items-center","justify-center","gap-10"],["alt","Regenesis Logo",1,"w-[70%]",3,"src"],[1,"uppercase","text-5xl","tracking-widest","text-secondary","font-medium","my-5"],[1,"w-full","flex","flex-col","items-center","justify-center","border-4","border-secondary","rounded-[3rem]","p-10","gap-8"],[1,"w-full","flex","flex-row","items-center","justify-center","gap-4","text-3xl"],[1,"w-1/2","flex","flex-row","items-center","justify-center","border-b-8","transition-all","duration-300","pb-5",3,"click"],[1,"w-1/2","flex","flex-row","items-center","justify-center","border-b-8","transition-all","duration-300","pb-3","gap-5",3,"click"],["alt","Favorite Icon",1,"w-8",3,"src"],[4,"ngIf","ngIfElse"],[1,"w-full","flex","flex-row","items-center","justify-center","gap-6","translate-x-6"],[3,"click","buttonName","textSize","paddingX","paddingY","borderSize"],[1,"duration-300","active:scale-90"],["alt","Preset Information",1,"w-12","active:scale-90","duration-300",3,"src"],[1,"w-[70%]",3,"click","buttonName","textSize","borderSize"],[1,"w-full","flex","flex-row","items-center","justify-center","gap-6"],[1,"w-28","h-28","flex","items-center","justify-center","border-4","border-secondary","rounded-full","duration-300","active:border-primary",3,"click"],["alt","",1,"w-20",3,"src"],["alt","",1,"w-16",3,"src"],[1,"w-screen","h-screen","bg-transparent","absolute","pointer-events-none","z-50"],[3,"isClose"],[1,"w-full","h-[15vh]","overflow-y-scroll","scroll-smooth","flex","flex-col","gap-4"],[3,"track","isFavorite","isCountdownActive","selected","countdownStatusChanged","favoriteToggled","trackSelected",4,"ngFor","ngForOf"],[3,"countdownStatusChanged","favoriteToggled","trackSelected","track","isFavorite","isCountdownActive","selected"]],template:function(i,t){if(i&1){let r=I();k(0,ce,2,1,"div",1),s(1,"app-layout",2)(2,"div",3),v(3,"img",4),s(4,"h1",5),h(5," Guided Breathwork "),l(),s(6,"div",6)(7,"div",7)(8,"button",8),g("click",function(){return m(r),f(t.selectTab("sessionLibrary"))}),h(9," Session Library "),l(),s(10,"button",9),g("click",function(){return m(r),f(t.selectTab("favorites"))}),h(11," Favorites "),v(12,"img",10),l()(),k(13,pe,3,1,"ng-container",11)(14,me,2,1,"ng-template",null,0,J),l(),s(16,"div",12)(17,"app-button",13),g("click",function(){return m(r),f(t.customizeYourEnvironment())}),l(),s(18,"button",14),v(19,"img",15),l()(),s(20,"app-button",16),g("click",function(){return m(r),f(t.playWRP())}),l(),s(21,"div",17)(22,"button",18),g("click",function(){return m(r),f(t.backToSelecSelfDev())}),v(23,"img",19),l(),s(24,"button",18),g("click",function(){return m(r),f(t.gotoHome())}),v(25,"img",20),l()()()()}if(i&2){let r=W(15);c("ngIf",t.stopDoorAnimation),a(),c("backgroundImage","background-image"),a(2),c("src",t.regenesisLogo,_),a(5),z(t.selectedTab==="sessionLibrary"?"text-primary border-primary":"text-secondary border-transparent "),a(2),z(t.selectedTab==="favorites"?"text-primary border-primary":"text-secondary border-transparent "),a(2),c("src",t.selectedTab==="favorites"?t.favoriteChecked:t.favoriteUnchecked,_),a(),c("ngIf",t.selectedTab==="sessionLibrary")("ngIfElse",r),a(4),c("buttonName","Customize Your Environment")("textSize","text-3xl")("paddingX","px-8")("paddingY","py-6")("borderSize","border-4"),a(2),c("src",t.information,_),a(),c("buttonName","Start Session")("textSize","text-4xl")("borderSize","border-4"),a(3),c("src",t.backButton,_),a(2),c("src",t.homeButton,_)}},dependencies:[G,P,q,E,Z,K,U]});let n=o;return n})();export{Pe as Task56Page};
