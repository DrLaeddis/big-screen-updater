import{a as _}from"./chunk-6HXTQR5D.js";import{i as E,j as b}from"./chunk-PQNYVRMP.js";import{a as S}from"./chunk-K3YAW35H.js";import{Ba as f,Ca as l,Ha as a,Ia as c,Ja as u,Ma as y,Na as g,Oa as P,Ra as T,Sa as w,Ta as V,W as v,Za as C,ca as m,da as h,ra as r,sa as p}from"./chunk-WH7RZBSH.js";var x=["videoPlayer"];function I(s,t){if(s&1){let k=y();a(0,"div",4)(1,"video",5,0),g("ended",function(){m(k);let o=P();return h(o.onVideoEnd())}),u(3,"source",6),c()()}s&2&&(r(),l("muted",!0)("controls",!1))}var F=(()=>{let t=class t{constructor(e){this.websocketService=e,this.doorClosed=!1,this.videoStarted=!1,this.lastPlayedTime=0,this.audioDuration=0,this.videoDuration=0}ngOnInit(){console.log("this is video console log"),console.log("check videoDuration",this.videoDuration),setTimeout(()=>{console.log("video start playing for the first time"),this.videoStarted=!0,this.doorClosed=!1,this.startVideo()},3e3),this.websocketService.onMessage("durationVideo").subscribe(e=>{if(console.log("Check duration message:",e),typeof e=="string")try{e=JSON.parse(e)}catch(d){console.log("Failed to parse message",d);return}let o=e.position/e.duration*100,i=this.videoPlayer.nativeElement,n=i.duration;if(console.log("check videoDuration",n),isNaN(n)){console.log("Video duration is not available yet.");return}let D=o/100*n,M=n-D;i.currentTime=M,i.play().catch(d=>{console.error("Error playing video:",d)}),console.log("Position Audio",e.position),console.log("Duration Audio",e.duration)})}ngAfterViewInit(){setTimeout(()=>{this.startVideo(),setTimeout(()=>{this.videoPlayer?(this.videoDuration=this.videoPlayer.nativeElement.duration,console.log("check video duration:",this.videoDuration)):console.log("videoPlayer element is not available")},100),this.websocketService.onMessage("pausevideo").subscribe(e=>{console.log("check message",e),e==="pause"?(console.log("pause video"),this.pauseVideo()):e==="resume"&&(console.log("resume video"),this.resumeVideo())})},3e3)}startVideo(){if(this.videoStarted=!0,this.videoPlayer){let e=this.videoPlayer.nativeElement;e.currentTime=this.lastPlayedTime,e.play().then(()=>{console.log("Video resumed from:",this.lastPlayedTime)}).catch(o=>{console.error("Error resuming video:",o)})}}pauseVideo(){if(this.videoPlayer){let e=this.videoPlayer.nativeElement;e.pause(),this.lastPlayedTime=e.currentTime,console.log("Video paused at:",this.lastPlayedTime)}}resumeVideo(){if(console.log("Attempting to resume video from last saved time..."),this.videoStarted=!0,this.videoPlayer){let e=this.videoPlayer.nativeElement;e.currentTime=this.lastPlayedTime,e.play().then(()=>{console.log("Video resumed from:",this.lastPlayedTime)}).catch(o=>{console.error("Error resuming video:",o)})}}onVideoEnd(){this.videoStarted=!1,this.doorClosed=!0}};t.\u0275fac=function(o){return new(o||t)(p(S))},t.\u0275cmp=v({type:t,selectors:[["app-task11"]],viewQuery:function(o,i){if(o&1&&T(x,5),o&2){let n;w(n=V())&&(i.videoPlayer=n.first)}},standalone:!0,features:[C],decls:3,vars:2,consts:[["videoPlayer",""],[1,"w-screen","h-screen","bg-transparent","absolute","pointer-events-none"],[3,"isClose"],["class","relative w-full h-full",4,"ngIf"],[1,"relative","w-full","h-full"],[1,"w-full","h-full","object-cover",3,"ended","muted","controls"],["src","sample.mp4","type","video/mp4"]],template:function(o,i){o&1&&(a(0,"div",1),u(1,"app-door",2),c(),f(2,I,4,2,"div",3)),o&2&&(r(),l("isClose",i.doorClosed),r(),l("ngIf",i.videoStarted))},dependencies:[_,b,E],styles:[".video-full[_ngcontent-%COMP%]{width:100vw;height:100vh;overflow:hidden;position:fixed;z-index:-1}.video[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}"]});let s=t;return s})();export{F as Task11Page};
